<tool id="cshl_fastx_quality_statistics_ng" name="Compute quality statistics">
	<description>(improved)</description>
	<command>
cat '$input' |
fastx_quality_stats
#if $input.ext == "fastqsanger":
 -Q 33
#elif $input.ext == "fastq":
 -Q 64
#end if
 -N -o '$output'
</command>

	<inputs>
		<param format="fasta,fastq,fastqsanger" name="input" type="data" label="Library to analyse" />
	</inputs>

	<tests>
		<test>
			<param name="input" value="fastq_stats1.fastq" />
			<output name="output" file="fastq_stats1.out" />
		</test>
	</tests>

	<outputs>
		<data format="tabular" name="output" metadata_source="input"
		/>
	</outputs>

<help>

**What it does**

Creates quality statistics report for the given Solexa/FASTQ library.

.. class:: warningmark

The output format is different than the old quality statistics tool. It can't be used for the quality-chart and nucleotide distribution tools (without further processing)

-----

**The output file will contain the following fields:**

* cycle   = cycle number (1 to 36 for a 36-cycles read solexa file)
* max-count = maximum number of bases (in all cycles)

For each nucleotide type of each cycle (ALL/A/C/G/T/N), the following columns are generated:

* count   = number of bases found in this column.
* min     = Lowest quality score value found in this column.
* max     = Highest quality score value found in this column.
* sum     = Sum of quality score values for this column.
* mean    = Mean quality score value for this column.
* Q1	= 1st quartile quality score.
* med	= Median quality score.
* Q3	= 3rd quartile quality score.
* IQR	= Inter-Quartile range (Q3-Q1).
* lW	= 'Left-Whisker' value (for boxplotting).
* rW	= 'Right-Whisker' value (for boxplotting).


(see column list at the bottom of this page)

-----

**Output Example**::

    cycle	max_count	ALL_count	ALL_min	ALL_max	ALL_sum	ALL_mean	ALL_Q1	ALL_med	ALL_Q3	ALL_IQR	ALL_lW	ALL_rW	A_count	A_min	A_max	A_sum	A_mean	A_Q1	A_med	A_Q3	A_IQR	A_lW	A_rW	C_count	C_min	C_max	C_sum	C_mean	C_Q1	C_med	C_Q3	C_IQR	C_lW	C_rW	G_count	G_min	G_max	G_sum	G_mean	G_Q1	G_med	G_Q3	G_IQR	G_lW	G_rW	T_count	T_min	T_max	T_sum	T_mean	T_Q1	T_med	T_Q3	T_IQR	T_lW	T_rW	N_count	N_min	N_max	N_sum	N_mean	N_Q1	N_med	N_Q3	N_IQR	N_lW	N_rW
    1	2827201	2827201	5	34	86622739	30.64	33	33	33	0	33	33	31337	5	34	841248	26.85	23	30	33	10	8	34	9269	5	34	154582	16.68	5	12	30	25	5	34	2095406	5	34	64401991	30.73	33	33	33	0	33	33	689133	5	34	21214602	30.78	33	33	33	0	33	33	2056	5	13	10316	5.02	5	5	5	0	5	5
    2	2827201	2827201	5	34	81416729	28.80	27	33	33	6	18	34	1860337	5	34	56188709	30.20	33	33	33	0	33	33	21274	5	34	420221	19.75	11	21	30	19	5	34	862406	5	34	22835654	26.48	21	32	33	12	5	34	81979	5	34	1964575	23.96	17	26	33	16	5	34	1205	5	24	7570	6.28	5	5	5	0	5	5
    3	2827201	2827201	5	34	89142476	31.53	33	33	34	1	32	34	18121	5	34	203489	11.23	5	5	15	10	5	30	45699	5	34	944362	20.66	5	26	33	28	5	34	79472	5	34	859251	10.81	5	5	12	7	5	22	2682082	5	34	87126165	32.48	33	33	34	1	32	34	1827	5	18	9209	5.04	5	5	5	0	5	5
    4	2827201	2827201	5	34	90033575	31.85	33	34	34	1	32	34	172281	5	34	2905831	16.87	5	11	33	28	5	34	2597111	5	34	85653490	32.98	33	34	34	1	32	34	24461	5	34	643275	26.30	23	33	33	10	8	34	32749	5	34	827798	25.28	17	33	33	16	5	34	599	5	21	3181	5.31	5	5	5	0	5	5
    5	2827201	2827201	5	34	89641650	31.71	33	33	34	1	32	34	26774	5	34	476388	17.79	5	13	33	28	5	34	58691	5	34	891506	15.19	5	5	32	27	5	34	54916	5	34	714335	13.01	5	5	24	19	5	34	2685062	5	34	87550414	32.61	33	33	34	1	32	34	1758	5	21	9007	5.12	5	5	5	0	5	5
    6	2827201	2827201	5	34	84595812	29.92	29	33	33	4	23	34	1204450	5	34	36229599	30.08	29	33	33	4	23	34	463119	5	34	13924930	30.07	30	33	33	3	26	34	712076	5	34	21093763	29.62	28	33	33	5	21	34	447508	5	34	13347178	29.83	29	33	33	4	23	34	48	5	21	342	7.12	5	5	7	2	5	10
    7	2827201	2827201	5	34	81404399	28.79	26	33	33	7	16	34	912751	5	34	26241597	28.75	26	33	33	7	16	34	540022	5	34	15843612	29.34	28	33	33	5	21	34	701269	5	34	19699830	28.09	26	32	33	7	16	34	672893	5	34	19617405	29.15	27	33	33	6	18	34	266	5	24	1955	7.35	5	5	7	2	5	10
    8	2827201	2827201	5	34	83714332	29.61	28	33	33	5	21	34	809852	5	34	23610246	29.15	27	33	33	6	18	34	563842	5	34	17062600	30.26	30	33	33	3	26	34	650887	5	34	18848062	28.96	27	33	33	6	18	34	802551	5	34	24192911	30.15	30	33	33	3	26	34	69	5	24	513	7.43	5	5	5	0	5	5
    9	2827201	2827201	5	34	83974872	29.70	28	33	33	5	21	34	834129	5	34	24483965	29.35	27	33	33	6	18	34	567059	5	34	17270502	30.46	30	33	33	3	26	34	620453	5	34	17917829	28.88	26	33	33	7	16	34	805499	5	34	24302177	30.17	30	33	33	3	26	34	61	5	26	399	6.54	5	5	5	0	5	5
    10	2827201	2827201	5	34	83278375	29.46	27	33	33	6	18	34	896783	5	34	26245652	29.27	27	33	33	6	18	34	551055	5	34	16628773	30.18	30	33	33	3	26	34	648328	5	34	18502443	28.54	26	33	33	7	16	34	730957	5	34	21900963	29.96	30	33	33	3	26	34	78	5	21	544	6.97	5	5	7	2	5	10
    11	2827201	2827201	5	34	82511316	29.18	27	33	33	6	18	34	857880	5	34	24789241	28.90	27	33	33	6	18	34	642205	5	34	19342469	30.12	30	33	33	3	26	34	655942	5	34	18484775	28.18	26	31	33	7	16	34	671046	5	34	19893945	29.65	28	33	33	5	21	34	128	5	24	886	6.92	5	5	5	0	5	5
    12	2827201	2827201	5	34	83171736	29.42	27	33	33	6	18	34	826807	5	34	24025084	29.06	27	33	33	6	18	34	586948	5	34	17775697	30.28	30	33	33	3	26	34	636734	5	34	17999923	28.27	26	31	33	7	16	34	776614	5	34	23370369	30.09	30	33	33	3	26	34	98	5	18	663	6.77	5	5	5	0	5	5
    13	2827201	2827201	5	34	82829608	29.30	27	33	33	6	18	34	822607	5	34	23762719	28.89	27	33	33	6	18	34	644718	5	34	19458385	30.18	30	33	33	3	26	34	591437	5	34	16607859	28.08	26	31	33	7	16	34	768323	5	34	22999812	29.94	30	33	33	3	26	34	116	5	24	833	7.18	5	5	7	2	5	10
    14	2827201	2827201	5	34	82345826	29.13	27	33	33	6	18	34	798164	5	34	22982673	28.79	26	33	33	7	16	34	649845	5	34	19506688	30.02	30	33	33	3	26	34	608966	5	34	16892044	27.74	24	31	33	9	11	34	770051	5	34	22963200	29.82	29	33	33	4	23	34	175	5	24	1221	6.98	5	5	5	0	5	5
    15	2827201	2827201	5	34	82462892	29.17	27	33	33	6	18	34	831167	5	34	23971929	28.84	26	33	33	7	16	34	613017	5	34	18416386	30.04	30	33	33	3	26	34	621149	5	34	17284205	27.83	24	31	33	9	11	34	761767	5	34	22789700	29.92	29	33	33	4	23	34	101	5	18	672	6.65	5	5	5	0	5	5
    16	2827201	2827201	5	34	82526664	29.19	27	33	33	6	18	34	824933	5	34	23753705	28.79	26	33	33	7	16	34	610126	5	34	18388479	30.14	30	33	33	3	26	34	612088	5	34	16999148	27.77	24	31	33	9	11	34	779925	5	34	23384436	29.98	30	33	33	3	26	34	129	5	24	896	6.95	5	5	5	0	5	5
    17	2827201	2827201	5	34	82610038	29.22	27	33	33	6	18	34	819008	5	34	23665033	28.89	27	33	33	6	18	34	618277	5	34	18651436	30.17	30	33	33	3	26	34	597414	5	34	16501609	27.62	24	30	33	9	11	34	792381	5	34	23791076	30.02	30	33	33	3	26	34	121	5	21	884	7.31	5	5	5	0	5	5
    18	2827201	2827201	5	34	82402647	29.15	27	33	33	6	18	34	815170	5	34	23471377	28.79	26	33	33	7	16	34	615913	5	34	18527086	30.08	30	33	33	3	26	34	607020	5	34	16707257	27.52	24	30	33	9	11	34	788977	5	34	23695988	30.03	30	33	33	3	26	34	121	5	24	939	7.76	5	5	11	6	5	20
    19	2827201	2827201	5	34	82124647	29.05	27	33	33	6	18	34	799663	5	34	22872641	28.60	26	32	33	7	16	34	628535	5	34	18876510	30.03	30	33	33	3	26	34	610246	5	34	16776560	27.49	24	30	33	9	11	34	788629	5	34	23598027	29.92	29	33	33	4	23	34	128	5	27	909	7.10	5	5	5	0	5	5
    20	2827201	2827201	5	34	81985110	29.00	27	33	33	6	18	34	797587	5	34	22834667	28.63	26	32	33	7	16	34	636494	5	34	19081110	29.98	30	33	33	3	26	34	603916	5	34	16456404	27.25	24	30	33	9	11	34	789056	5	34	23611835	29.92	29	33	33	4	23	34	148	5	27	1094	7.39	5	5	7	2	5	10
    21	2827201	2827201	5	34	81789492	28.93	27	33	33	6	18	34	794078	5	34	22654429	28.53	26	32	33	7	16	34	636334	5	34	19008271	29.87	29	33	33	4	23	34	614943	5	34	16761297	27.26	24	30	33	9	11	34	781661	5	34	23364202	29.89	29	33	33	4	23	34	185	5	27	1293	6.99	5	5	5	0	5	5
    22	2827201	2827201	5	34	81451811	28.81	27	33	33	6	18	34	789032	5	34	22366485	28.35	26	31	33	7	16	34	645777	5	34	19277917	29.85	29	33	33	4	23	34	608030	5	34	16404902	26.98	23	29	33	10	8	34	784198	5	34	23401407	29.84	29	33	33	4	23	34	164	5	24	1100	6.71	5	5	5	0	5	5
    23	2827201	2827201	5	34	80945146	28.63	26	32	33	7	16	34	786207	5	34	22128593	28.15	26	31	33	7	16	34	647440	5	34	19187231	29.64	28	33	33	5	21	34	607663	5	34	16274550	26.78	22	29	33	11	6	34	785744	5	34	23353803	29.72	29	33	33	4	23	34	147	5	24	969	6.59	5	5	5	0	5	5
    24	2827201	2827201	5	34	80501327	28.47	26	32	33	7	16	34	786929	5	34	22067207	28.04	26	31	33	7	16	34	645831	5	34	19042366	29.49	28	33	33	5	21	34	612772	5	34	16261175	26.54	22	29	33	11	6	34	781496	5	34	23129334	29.60	28	33	33	5	21	34	173	5	26	1245	7.20	5	5	5	0	5	5
    25	2827201	2827201	5	34	79714527	28.20	26	31	33	7	16	34	782000	5	34	21701186	27.75	24	30	33	9	11	34	644171	5	34	18796511	29.18	27	33	33	6	18	34	617490	5	34	16226119	26.28	22	28	33	11	6	34	783396	5	34	22989588	29.35	27	33	33	6	18	34	144	5	26	1123	7.80	5	5	11	6	5	20
    26	2827201	2827201	5	34	77523225	27.42	24	31	33	9	11	34	783881	5	34	21162231	27.00	24	30	33	9	11	34	645075	5	34	18368273	28.47	27	33	33	6	18	34	617885	5	34	15635967	25.31	21	27	33	12	5	34	779368	5	34	22349766	28.68	27	33	33	6	18	34	992	5	27	6988	7.04	5	5	5	0	5	5
    27	2827201	2827201	5	34	76792679	27.16	24	31	33	9	11	34	788575	5	34	21113021	26.77	23	30	33	10	8	34	638456	5	34	18023093	28.23	26	32	33	7	16	34	624665	5	34	15600176	24.97	21	27	33	12	5	34	774483	5	34	22049478	28.47	27	32	33	6	18	34	1022	5	27	6911	6.76	5	5	5	0	5	5
    28	2827201	2827201	5	34	76446203	27.04	24	30	33	9	11	34	783001	5	34	20828394	26.60	22	30	33	11	6	34	639424	5	34	17921638	28.03	26	32	33	7	16	34	621361	5	34	15437055	24.84	21	27	33	12	5	34	782313	5	34	22251729	28.44	27	32	33	6	18	34	1102	5	26	7387	6.70	5	5	5	0	5	5
    29	2827201	2827201	5	34	75869397	26.84	24	30	33	9	11	34	777718	5	34	20485923	26.34	22	30	33	11	6	34	645283	5	34	18004108	27.90	26	31	33	7	16	34	627295	5	34	15440771	24.61	21	27	33	12	5	34	775728	5	34	21930783	28.27	26	32	33	7	16	34	1177	5	27	7812	6.64	5	5	5	0	5	5
    30	2827201	2827201	5	34	75137420	26.58	22	30	33	11	6	34	779313	5	34	20336426	26.10	22	29	33	11	6	34	646974	5	34	17887122	27.65	24	31	33	9	11	34	626980	5	34	15205903	24.25	19	26	33	14	5	34	772774	5	34	21699992	28.08	26	31	33	7	16	34	1160	5	27	7977	6.88	5	5	5	0	5	5
    31	2827201	2827201	5	34	74256817	26.27	22	30	33	11	6	34	780211	5	34	20171360	25.85	21	29	33	12	5	34	645371	5	34	17606830	27.28	24	31	33	9	11	34	629456	5	34	14997599	23.83	18	26	33	15	5	34	771023	5	34	21473316	27.85	26	31	33	7	16	34	1140	5	27	7712	6.76	5	5	5	0	5	5
    32	2827201	2827201	5	34	73624704	26.04	22	29	33	11	6	34	776741	5	34	19802248	25.49	21	28	33	12	5	34	642994	5	34	17408712	27.07	24	30	33	9	11	34	631699	5	34	14925494	23.63	18	26	32	14	5	34	774316	5	34	21478972	27.74	26	31	33	7	16	34	1451	5	27	9278	6.39	5	5	5	0	5	5
    33	2827201	2827201	5	34	72833249	25.76	21	29	33	12	5	34	775426	5	34	19509710	25.16	21	27	33	12	5	34	644177	5	34	17265182	26.80	24	30	33	9	11	34	627490	5	34	14612407	23.29	18	26	31	13	5	34	778476	5	34	21435400	27.54	24	31	33	9	11	34	1632	5	27	10550	6.46	5	5	5	0	5	5
    34	2827201	2827201	5	34	71937995	25.44	21	28	33	12	5	34	772803	5	34	19226676	24.88	21	27	33	12	5	34	647127	5	34	17098061	26.42	22	30	33	11	6	34	628686	5	34	14382900	22.88	17	24	31	14	5	34	777289	5	34	21221307	27.30	24	30	33	9	11	34	1296	5	27	9051	6.98	5	5	5	0	5	5
    35	2827201	2827201	5	34	70604895	24.97	21	27	33	12	5	34	769554	5	34	18722160	24.33	19	27	32	13	5	34	643915	5	34	16662802	25.88	21	28	33	12	5	34	627642	5	34	14115224	22.49	17	24	30	13	5	34	784712	5	34	21095775	26.88	24	30	33	9	11	34	1378	5	27	8934	6.48	5	5	5	0	5	5
    36	2827201	2827201	5	34	71705284	25.36	21	28	33	12	5	34	775278	5	34	18770248	24.21	18	27	33	15	5	34	634906	5	34	16703972	26.31	22	30	33	11	6	34	630819	5	34	14421307	22.86	17	24	31	14	5	34	784826	5	34	21800547	27.78	26	32	33	7	16	34	1372	5	27	9210	6.71	5	5	5	0	5	5

-----

All columns::

    cycle
    max_count
    ALL_count
    ALL_min
    ALL_max
    ALL_sum
    ALL_mean
    ALL_Q1
    ALL_med
    ALL_Q3
    ALL_IQR
    ALL_lW
    ALL_rW
    A_count
    A_min
    A_max
    A_sum
    A_mean
    A_Q1
    A_med
    A_Q3
    A_IQR
    A_lW
    A_rW
    C_count
    C_min
    C_max
    C_sum
    C_mean
    C_Q1
    C_med
    C_Q3
    C_IQR
    C_lW
    C_rW
    G_count
    G_min
    G_max
    G_sum
    G_mean
    G_Q1
    G_med
    G_Q3
    G_IQR
    G_lW
    G_rW
    T_count
    T_min
    T_max
    T_sum
    T_mean
    T_Q1
    T_med
    T_Q3
    T_IQR
    T_lW
    T_rW
    N_count
    N_min
    N_max
    N_sum
    N_mean
    N_Q1
    N_med
    N_Q3
    N_IQR
    N_lW
    N_rW

------

This tool is based on `FASTX-toolkit`__ by Assaf Gordon.

 .. __: http://hannonlab.cshl.edu/fastx_toolkit/

</help>
</tool>
<!-- FASTQ-Statistics is part of the FASTX-toolkit, by A.Gordon (assafgordon@gmail.com) -->
